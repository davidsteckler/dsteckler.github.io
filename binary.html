<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binary Bulbs Game</title>
    <style>
        body {
            text-align: center;
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            color: #333333;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        h1 {
            color: #333;
            margin-bottom: 40px;
            font-size: 2.5em;
        }
        .game-container {
            max-width: 900px;
            width: 100%;
        }
        #bulbs {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }
        .bulb-container {
            display: inline-block;
            position: relative;
        }
        .bulb-label {
            position: absolute;
            top: -25px;
            width: 100%;
            text-align: center;
            font-weight: bold;
            color: #333;
            font-size: 1.2em;
        }
        .bulb {
            width: 80px;
            height: 80px;
            border: 2px solid #333;
            border-radius: 50% 50% 10% 10%;
            line-height: 80px;
            font-size: 1.8em;
            font-weight: bold;
            background-color: #f0f0f0;
            color: #333;
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .bulb.on {
            background-color: yellow;
            box-shadow: 0 0 20px yellow;
        }
        #placeValueSum {
            font-size: 1.2em;
            margin: 10px 0;
            color: #666;
        }
        #numberDisplay, #binaryDisplay {
            font-size: 1.5em;
            margin: 10px 0;
        }
        .controls {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
        }
        .toggle-container {
            display: flex;
            align-items: center;
        }
        .toggle-label {
            margin-right: 10px;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #2196F3;
        }
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        .button-container {
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s ease;
            margin: 5px;
        }
        button:hover {
            background-color: #555;
        }
        .page-break {
            border-top: 1px solid #ccc;
            margin: 40px 0;
            width: 100%;
        }
        .info-section {
            text-align: left;
            padding-top: 20px;
        }
        .info-section h2 {
            margin-bottom: 15px;
            color: #333;
        }
        .info-section p {
            margin-bottom: 15px;
            color: #666;
            line-height: 1.6;
        }
        @keyframes flash {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        .flashing {
            animation: flash 0.5s linear infinite;
        }
        @media (max-width: 600px) {
            .bulb {
                width: 45px;
                height: 45px;
                line-height: 45px;
                font-size: 1.2em;
            }
            .bulb-label {
                font-size: 0.8em;
                top: -20px;
            }
            h1 {
                font-size: 2em;
                margin-bottom: 20px;
            }
            #placeValueSum, #numberDisplay, #binaryDisplay {
                font-size: 1em;
                margin: 5px 0;
            }
            .controls {
                flex-direction: column;
                gap: 10px;
            }
            .toggle-label {
                margin-right: 5px;
            }
            .switch {
                width: 50px;
                height: 30px;
            }
            .switch .slider:before {
                width: 22px;
                height: 22px;
            }
            button {
                padding: 5px 10px;
                font-size: 14px;
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>
    <h1>Binary Bulbs Game</h1>
    
    <div class="game-container">
        <div id="bulbs"></div>

        <div id="placeValueSum">Sum: 0 = 0</div>

        <div id="numberDisplay">Decimal: 0</div>
        <div id="binaryDisplay">Binary: 00000000</div>

        <div class="controls">
            <div class="toggle-container">
                <span class="toggle-label">Difficulty:</span>
                <label class="switch">
                    <input type="checkbox" id="difficultyToggle">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="toggle-container">
                <span class="toggle-label">Game Mode:</span>
                <label class="switch">
                    <input type="checkbox" id="gameModeToggle">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="toggle-container">
                <span class="toggle-label">Labels:</span>
                <label class="switch">
                    <input type="checkbox" id="labelsToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="button-container">
            <button onclick="resetBits()">Reset</button>
            <button onclick="randomizeBits()">Randomize</button>
        </div>

        <div id="alert" style="display: none; margin-top: 20px; padding: 10px; background-color: #f0f0f0; border-radius: 5px;">
            <span>Create the binary representation of: <span id="target"></span></span>
            <button id="newChallengeButton" style="display: none;" onclick="startNewGame()">New Challenge</button>
        </div>

        <div class="page-break"></div>

        <div class="info-section">
            <h2>What is Binary?</h2>
            <p>
                Binary is the language of computers, using just two states: on and off, represented by 1 and 0. In our everyday world, we use the decimal system with ten digits, but computers think in this simple binary code.
            </p>
            <p>
                Each bulb above represents a binary digit or 'bit'. When it's on (yellow), it adds its value to the total. The rightmost bulb is worth 1, and each bulb to the left doubles in value.
            </p>
            <p>
                Experiment with the bulbs above. Toggle them on and off, and watch how the decimal number changes. Can you create specific numbers? This is how computers build complex data from simple on/off switches!
            </p>
        </div>
    </div>

    <script>
        let bits = [0, 0, 0, 0, 0, 0, 0, 0];
        let target = 0;
        let isHardMode = false;
        const difficultyToggle = document.getElementById('difficultyToggle');
        const gameModeToggle = document.getElementById('gameModeToggle');
        const labelsToggle = document.getElementById('labelsToggle');
        const alertElement = document.getElementById('alert');
        const targetElement = document.getElementById('target');
        const newChallengeButton = document.getElementById('newChallengeButton');
        const placeValueSumElement = document.getElementById('placeValueSum');
        const bulbsContainer = document.getElementById('bulbs');

        function createBulbs() {
            bulbsContainer.innerHTML = '';
            const values = [128, 64, 32, 16, 8, 4, 2, 1];
            values.forEach((value, index) => {
                const container = document.createElement('div');
                container.className = 'bulb-container';
                
                const label = document.createElement('div');
                label.className = 'bulb-label';
                label.textContent = value;
                
                const bulb = document.createElement('div');
                bulb.className = 'bulb';
                bulb.textContent = '0';
                
                bulb.addEventListener('click', () => toggleBit(index));
                
                container.appendChild(label);
                container.appendChild(bulb);
                bulbsContainer.appendChild(container);
            });
        }

        function toggleBit(index) {
            bits[index] = 1 - bits[index];
            updateDisplay();
        }

        function updateDisplay() {
            const bulbElements = document.querySelectorAll('.bulb');
            bulbElements.forEach((element, index) => {
                element.classList.toggle('on', bits[index] === 1);
                element.textContent = bits[index];
            });

            let number = bits.reduce((acc, bit, index) => acc + bit * Math.pow(2, 7 - index), 0);
            let binary = bits.join('');

            if (gameModeToggle.checked && isHardMode) {
                document.getElementById('numberDisplay').textContent = `Target: ${target}`;
                document.getElementById('binaryDisplay').textContent = 'Binary: ????????';
                placeValueSumElement.textContent = 'Sum: Hidden in Hard Mode';
            } else {
                document.getElementById('numberDisplay').textContent = `Decimal: ${number}`;
                document.getElementById('binaryDisplay').textContent = `Binary: ${binary}`;
                
                let placeValueSum = bits.reduce((sum, bit, index) => {
                    let placeValue = Math.pow(2, 7 - index);
                    return sum + (bit === 1 ? `${placeValue} + ` : '');
                }, '').slice(0, -3) || '0';
                placeValueSumElement.textContent = `Sum: ${placeValueSum} = ${number}`;
            }

            if (gameModeToggle.checked) {
                document.getElementById('numberDisplay').textContent += ` | Target: ${target}`;
                if (number === target) {
                    celebrateWin();
                } else {
                    newChallengeButton.style.display = 'none';
                }
            }
        }

        function celebrateWin() {
            const bulbElements = document.querySelectorAll('.bulb');
            alertElement.innerHTML = `<span class="flashing">Congratulations! You've reached the target: ${target}</span>`;
            alertElement.style.display = 'block';

            let danceCount = 0;
            const danceInterval = setInterval(() => {
                bulbElements.forEach(bulb => {
                    bulb.classList.toggle('on', Math.random() < 0.5);
                    bulb.textContent = bulb.classList.contains('on') ? '1' : '0';
                });
                danceCount++;
                if (danceCount >= 10) {
                    clearInterval(danceInterval);
                    resetBits();
                    alertElement.classList.remove('flashing');
                    alertElement.innerHTML = `<span>Congratulations! You've reached the target: ${target}</span>
                                              <button onclick="startNewGame()">New Challenge</button>`;
                    newChallengeButton.style.display = 'inline-block';
                }
            }, 200);
        }

        function resetBits() {
            bits = [0, 0, 0, 0, 0, 0, 0, 0];
            updateDisplay();
        }

        function randomizeBits() {
            bits = bits.map(() => Math.round(Math.random()));
            updateDisplay();
        }

        function startNewGame() {
            target = Math.floor(Math.random() * 256);
            targetElement.textContent = target;
            resetBits();
            alertElement.style.display = 'block';
            alertElement.innerHTML = `<span>Create the binary representation of: <span id="target">${target}</span></span>`;
            newChallengeButton.style.display = 'none';
            
            if (isHardMode) {
                setTimeout(() => {
                    updateDisplay();
                }, 5000);
            } else {
                updateDisplay();
            }
        }

        difficultyToggle.addEventListener('change', () => {
            isHardMode = difficultyToggle.checked;
            if (gameModeToggle.checked) {
                startNewGame();
            }
        });

        gameModeToggle.addEventListener('change', () => {
            if (gameModeToggle.checked) {
                startNewGame();
            } else {
                alertElement.style.display = 'none';
                updateDisplay();
            }
        });

        labelsToggle.addEventListener('change', () => {
            document.querySelectorAll('.bulb-label').forEach(label => {
                label.style.display = labelsToggle.checked ? 'block' : 'none';
            });
        });

        createBulbs();
        updateDisplay();
    </script>
</body>
</html>
