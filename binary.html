<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binary Boxes Game</title>
    <style>
        body {
            text-align: center;
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            color: #333333;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        .game-container {
            max-width: 800px;
            width: 100%;
        }
        #boxes {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        .box-container {
            display: inline-block;
            position: relative;
        }
        .box {
            width: 70px;
            height: 70px;
            border: 2px solid #333;
            line-height: 70px;
            font-size: 1.5em;
            font-weight: bold;
            background-color: #fff;
            color: #333;
            transition: background-color 0.3s ease, color 0.3s ease;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .box.on {
            background-color: yellow;
            color: #333;
        }
        .box-label {
            position: absolute;
            top: -30px;
            width: 100%;
            text-align: center;
            font-weight: bold;
            color: #333;
            font-size: 1.2em;
        }
        .controller {
            margin-top: 20px;
        }
        .switch {
            display: inline-block;
            width: 34px;
            height: 20px;
            margin: 10px;
            position: relative;
        }
        .switch input {
            display: none;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 20px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 12px;
            width: 12px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #333;
        }
        input:checked + .slider:before {
            transform: translateX(14px);
        }
        #numberDisplay {
            font-size: 2em;
            margin: 10px 0;
        }
        #binaryDisplay {
            font-size: 1.5em;
            margin: 10px 0;
        }
        .button-container {
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s ease;
            margin: 0 5px;
        }
        button:hover {
            background-color: #555;
        }
        .arrow {
            cursor: pointer;
            font-size: 2em;
            user-select: none;
            color: #333;
        }
        .arrow-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }
        .alert {
            background-color: #444;
            color: #fff;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .info-section {
            margin: 20px 0;
            text-align: left;
            max-width: 800px;
        }
        .info-section h2 {
            margin-bottom: 10px;
            color: #333;
        }
        .info-section p {
            margin-bottom: 10px;
            color: #666;
            line-height: 1.6;
        }
        .toggle-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        .toggle-item {
            display: flex;
            align-items: center;
        }
        .toggle-item span {
            margin-right: 10px;
        }
        #placeValueSum {
            font-size: 1.2em;
            margin-top: 10px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>Binary Boxes Game</h1>
        <div class="info-section">
            <h2>What is Binary?</h2>
            <p>Binary is a base-2 number system that uses only two digits, 0 and 1. Every digital device uses binary to process and store data. In this game, each box represents a binary digit (bit) with a specific place value. The rightmost box has a place value of 1, and each box to the left doubles in value. Click on the boxes to toggle them on (yellow) or off (white). The sum of the place values of all "on" boxes gives you the decimal number.</p>
        </div>
        <div id="boxes">
            <div class="box-container" data-value="128"><div class="box-label">128</div><div class="box">0</div></div>
            <div class="box-container" data-value="64"><div class="box-label">64</div><div class="box">0</div></div>
            <div class="box-container" data-value="32"><div class="box-label">32</div><div class="box">0</div></div>
            <div class="box-container" data-value="16"><div class="box-label">16</div><div class="box">0</div></div>
            <div class="box-container" data-value="8"><div class="box-label">8</div><div class="box">0</div></div>
            <div class="box-container" data-value="4"><div class="box-label">4</div><div class="box">0</div></div>
            <div class="box-container" data-value="2"><div class="box-label">2</div><div class="box">0</div></div>
            <div class="box-container" data-value="1"><div class="box-label">1</div><div class="box">0</div></div>
        </div>
        <div id="placeValueSum"></div>
        <div class="arrow-container">
            <div class="arrow" onclick="incrementNumber()">&#9650;</div>
            <div id="numberDisplay">Decimal: 0</div>
            <div id="binaryDisplay">Binary: 0</div>
            <div class="arrow" onclick="decrementNumber()">&#9660;</div>
        </div>
        <div class="toggle-container">
            <div class="toggle-item">
                <span>Boxes</span>
                <label class="switch">
                    <input type="checkbox" id="boxesOn" checked>
                    <span class="slider"></span>
                </label>
            </div>
            <div class="toggle-item">
                <span>Game Mode</span>
                <label class="switch">
                    <input type="checkbox" id="gameMode">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="toggle-item">
                <span>Labels</span>
                <label class="switch">
                    <input type="checkbox" id="showLabels" checked>
                    <span class="slider"></span>
                </label>
            </div>
        </div>
        <div class="button-container">
            <button onclick="resetBoxes()">Reset</button>
            <button onclick="randomizeBits()">Randomize</button>
        </div>
        <div id="alert" class="alert" style="display: none;">
            <span>Create the binary representation of: <span id="target"></span></span>
            <button id="newChallengeButton" style="display: none;" onclick="startNewGame()">New Challenge</button>
        </div>
    </div>
    <script>
        let bits = [0, 0, 0, 0, 0, 0, 0, 0];
        let target = 0;
        const boxesOnCheckbox = document.getElementById('boxesOn');
        const gameModeCheckbox = document.getElementById('gameMode');
        const showLabelsCheckbox = document.getElementById('showLabels');
        const alertElement = document.getElementById('alert');
        const targetElement = document.getElementById('target');
        const newChallengeButton = document.getElementById('newChallengeButton');
        const placeValueSumElement = document.getElementById('placeValueSum');

        document.querySelectorAll('.box').forEach((box, index) => {
            box.addEventListener('click', () => {
                if (boxesOnCheckbox.checked) {
                    bits[index] = bits[index] === 0 ? 1 : 0;
                    box.classList.toggle('on');
                    box.innerText = bits[index];
                    updateNumber();
                }
            });
        });

        boxesOnCheckbox.addEventListener('change', () => {
            document.querySelectorAll('.box').forEach((box, index) => {
                if (!boxesOnCheckbox.checked) {
                    bits[index] = 0;
                    box.classList.remove('on');
                    box.innerText = bits[index];
                }
            });
            updateNumber();
        });

        gameModeCheckbox.addEventListener('change', () => {
            if (gameModeCheckbox.checked) {
                startNewGame();
            } else {
                alertElement.style.display = 'none';
                updateNumber();
            }
        });

        showLabelsCheckbox.addEventListener('change', () => {
            document.querySelectorAll('.box-label').forEach(label => {
                label.style.display = showLabelsCheckbox.checked ? 'block' : 'none';
            });
        });

        function updateNumber() {
            let number = bits.reduce((acc, bit, index) => acc + bit * Math.pow(2, 7 - index), 0);
            let binary = bits.join('');
            document.getElementById('numberDisplay').innerText = `Decimal: ${number}`;
            document.getElementById('binaryDisplay').innerText = `Binary: ${binary}`;
            
            // Update place value sum
            let placeValueSum = bits.reduce((sum, bit, index) => {
                let placeValue = Math.pow(2, 7 - index);
                return sum + (bit === 1 ? `${placeValue} + ` : '');
            }, '').slice(0, -3); // Remove the last ' + '
            placeValueSumElement.innerText = `Sum: ${placeValueSum} = ${number}`;

            if (gameModeCheckbox.checked) {
                document.getElementById('numberDisplay').innerText = `Decimal: ${number} | Target: ${target}`;
                if (number === target) {
                    newChallengeButton.style.display = 'inline-block';
                    alertElement.style.backgroundColor = '#27ae60';
                    alertElement.innerHTML = `<span>Congratulations! You've reached the target: ${target}</span>
                                              <button onclick="startNewGame()">New Challenge</button>`;
                } else {
                    alertElement.style.backgroundColor = '#444';
                    newChallengeButton.style.display = 'none';
                }
            }
        }

        function resetBoxes() {
            bits = [0, 0, 0, 0, 0, 0, 0, 0];
            document.querySelectorAll('.box').forEach(box => {
                box.classList.remove('on');
                box.innerText = 0;
            });
            updateNumber();
        }

        function randomizeBits() {
            bits = bits.map(() => Math.round(Math.random()));
            document.querySelectorAll('.box').forEach((box, index) => {
                box.classList.toggle('on', bits[index] === 1);
                box.innerText = bits[index];
            });
            updateNumber();
        }

        function incrementNumber() {
            let number = bits.reduce((acc, bit, index) => acc + bit * Math.pow(2, 7 - index), 0);
            if (number < 255) {
                number += 1;
                setBitsFromNumber(number);
            }
        }

        function decrementNumber() {
            let number = bits.reduce((acc, bit, index) => acc + bit * Math.pow(2, 7 - index), 0);
            if (number > 0) {
                number -= 1;
                setBitsFromNumber(number);
            }
        }

        function setBitsFromNumber(number) {
            bits = bits.map((_, index) => (number & (1 << (7 - index))) ? 1 : 0);
            document.querySelectorAll('.box').forEach((box, index) => {
                box.classList.toggle('on', bits[index] === 1);
                box.innerText = bits[index];
            });
            updateNumber();
        }

        function startNewGame() {
            target = Math.floor(Math.random() * 256);
            targetElement.innerText = target;
            resetBoxes();
            alertElement.style.display = 'flex';
            alertElement.style.backgroundColor = '#444';
            alertElement.innerHTML = `<span>Create the binary representation of: ${target}</span>`;
            newChallengeButton.style.display = 'none';
        }

        // Initialize the game
        updateNumber();
    </script>
</body>
</html>
